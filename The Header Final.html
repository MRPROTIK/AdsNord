<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TJD38MXS');</script>
<!-- End Google Tag Manager -->

<style>
  :root {
    --g-blue: #4285F4; --g-red: #EA4335; --g-yellow: #FBBC05; --g-green: #34A853;
    --transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);

    /* Light theme */
    --bg-body: #ffffff;
    --text-main: #0f172a;
    --text-muted: #475569;
    --glass-border: rgba(0, 0, 0, 0.10);

    /* Next-Zen glass */
    --zen-hue: 205;
    --zen-blur: 18px;
    --zen-sat: 145%;
    --zen-alpha: .14;
    --zen-shadow: .14;
    --zen-stroke: .10;
  }

  /* =========================
     âœ… PATCH: CSS scoping hardening (header-only)
     ========================= */
  .adsnord-header,
  .adsnord-header *{ box-sizing: border-box; margin: 0; padding: 0; }

  .adsnord-header{
    font-family: 'Inter', sans-serif;
    color: var(--text-main);
  }

  /* âœ… PATCH: Body scroll lock when mobile menu open */
  body.menu-open{
    overflow: hidden;
    height: 100vh;
    touch-action: none;
  }

  /* âœ… PATCH: Focus-visible (keyboard accessibility) */
  .adsnord-header a:focus-visible,
  .adsnord-header button:focus-visible{
    outline: 3px solid rgba(66,133,244,.45);
    outline-offset: 4px;
    border-radius: 12px;
  }

  /* Progress bar */
  .adsnord-header .scroll-progress { position: fixed; top: 0; left: 0; width: 0%; height: 4px; background: var(--g-blue); z-index: 1001; }

  .adsnord-header .header-wrapper{
    position: fixed;
    top: 18px;
    left: 0;
    width: 100%;
    z-index: 1000;
    padding: 0 18px;
    padding-top: env(safe-area-inset-top);
  }

  body.admin-bar .adsnord-header .header-wrapper{
    top: calc(18px + 32px) !important;
  }

  @media (max-width: 782px){
    body.admin-bar .adsnord-header .header-wrapper{
      top: calc(18px + 46px) !important;
    }
  }

  .adsnord-header header{
    max-width: 1300px;
    margin: 0 auto;
    border-radius: 30px;
    padding: 16px 0;
    transition: var(--transition);
    overflow: visible;
    position: relative;

    border: none !important;
    background: linear-gradient(
      135deg,
      rgba(92,225,255, calc(var(--zen-alpha) + .02)),
      rgba(167,139,250, var(--zen-alpha))
    ) !important;

    backdrop-filter: blur(var(--zen-blur)) saturate(var(--zen-sat)) !important;
    -webkit-backdrop-filter: blur(var(--zen-blur)) saturate(var(--zen-sat)) !important;

    box-shadow:
      0 16px 40px rgba(0,0,0, var(--zen-shadow)),
      inset 0 -1px 0 rgba(255,255,255, var(--zen-stroke)) !important;
  }

  .adsnord-header .header-flex,
  .adsnord-header .header-actions,
  .adsnord-header nav{
    overflow: visible !important;
  }

  .adsnord-header .header-flex { display:flex; justify-content:space-between; align-items:center; padding: 0 22px; }
  .adsnord-header .logo-holder { display:flex; align-items:center; gap:12px; text-decoration:none; }
  .adsnord-header .logo-text { font-size:1.5rem; font-weight:900; color: var(--g-blue); letter-spacing:-0.5px; }
  .adsnord-header .logo-text span { color: var(--g-yellow); }

  .adsnord-header .nav-links { display:flex; list-style:none; gap: 32px; align-items:center; }
  .adsnord-header .nav-links a { text-decoration:none; color: var(--text-main); font-weight: 600; font-size: .95rem; transition: .3s; }
  .adsnord-header .nav-links a:hover { color: var(--g-blue); }

  .adsnord-header .header-actions { display:flex; align-items:center; gap: 20px; }

  .adsnord-header .menu-btn { display:none; background:none; border:none; cursor:pointer; padding: 6px; z-index: 2100; }
  .adsnord-header .menu-btn span { display:block; width: 26px; height: 2px; background: var(--text-main); margin: 6px 0; transition: var(--transition); }
  .adsnord-header .menu-btn.open span:nth-child(1) { transform: translateY(4px) rotate(45deg); }
  .adsnord-header .menu-btn.open span:nth-child(2) { transform: translateY(-4px) rotate(-45deg); }

  /* Dropdown desktop */
  .adsnord-header .dropdown { position: relative; }
  .adsnord-header .dropdown-menu{
    position:absolute; top:100%; left:0;
    background: rgba(255,255,255,.92);
    backdrop-filter: blur(18px) saturate(150%);
    -webkit-backdrop-filter: blur(18px) saturate(150%);
    border: 1px solid rgba(0,0,0,.08);
    border-radius: 12px;
    list-style:none;
    padding: 10px 0;
    min-width: 260px;
    opacity:0; visibility:hidden;
    transform: translateY(10px);
    transition: var(--transition);
    z-index: 99999;
    box-shadow: 0 10px 30px rgba(0,0,0,.10);
  }
  .adsnord-header .dropdown:hover .dropdown-menu { opacity:1; visibility:visible; transform: translateY(0); }
  .adsnord-header .dropdown-menu li a { padding: 12px 20px; display:block; font-size: .85rem !important; color: var(--text-main); }
  .adsnord-header .dropdown-menu li a:hover { background: rgba(66,133,244,.10); color: var(--g-blue) !important; }

  .adsnord-header header::after{
    content:"";
    position:absolute;
    left:16px; right:16px; top:0;
    height:1px; pointer-events:none;
    background: linear-gradient(
      90deg,
      transparent,
      hsla(var(--zen-hue), 95%, 70%, .55),
      hsla(calc(var(--zen-hue) + 35), 95%, 72%, .50),
      hsla(calc(var(--zen-hue) + 75), 95%, 72%, .40),
      transparent
    );
    opacity:0;
    transform: translateY(-2px);
    transition: opacity .25s ease, transform .25s ease;
  }

  /* Mobile overlay */
  .adsnord-header .mobile-overlay{
    position: fixed;
    top: 0; right: -100%;
    width: 100%;
    height: 100dvh;
    z-index: 2005;
    display:flex;
    flex-direction:column;
    align-items:flex-start;
    justify-content:flex-start;
    padding: calc(90px + env(safe-area-inset-top)) 22px 40px;
    transition: .5s cubic-bezier(.23,1,.32,1);
    overflow-y:auto;

    background: linear-gradient(
      135deg,
      rgba(255,255,255,.92),
      rgba(255,255,255,.82)
    );
    backdrop-filter: blur(18px) saturate(150%);
    -webkit-backdrop-filter: blur(18px) saturate(150%);
  }
  .adsnord-header .mobile-overlay.active { right: 0; }

  .adsnord-header .m-close{
    position: absolute;
    top: calc(18px + env(safe-area-inset-top));
    right: 18px;
    width: 44px;
    height: 44px;
    border: none;
    border-radius: 14px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(255,255,255,.85);
    border: 1px solid rgba(0,0,0,.08);
    backdrop-filter: blur(14px) saturate(150%);
    -webkit-backdrop-filter: blur(14px) saturate(150%);
    box-shadow: 0 10px 25px rgba(0,0,0,.10);
    z-index: 2010;
  }
  .adsnord-header .m-close i{ font-size: 18px; color: #0f172a; }

  .adsnord-header .mobile-overlay a{
    text-decoration:none;
    font-weight: 900;
    letter-spacing: .2px;
    opacity: 1 !important;
  }
  .adsnord-header .m-link-main{
    color: #0f172a !important;
    font-size: 1.55rem !important;
    margin-bottom: 14px !important;
  }
  .adsnord-header .m-link-parent{
    color: var(--g-blue) !important;
    font-size: 1.65rem !important;
    margin-top: 18px !important;
    margin-bottom: 10px !important;

    /* âœ… PATCH: make room for arrow button */
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 12px;
  }
  .adsnord-header .mobile-sub-links{
    display:flex; flex-direction:column;
    padding-left: 14px;
    margin-bottom: 18px;
    border-left: 2px solid rgba(66,133,244,.30);
  }
  .adsnord-header .mobile-sub-links a{
    font-size: 1.05rem !important;
    font-weight: 700 !important;
    color: #334155 !important;
    margin-bottom: 10px !important;
  }

  @media (max-width: 1024px){
    .adsnord-header .header-wrapper { top: 14px; padding: 0 12px; }
  }
  @media (max-width: 768px){
    .adsnord-header .nav-links{ display:none; }
    .adsnord-header .menu-btn{ display:block; }
    .adsnord-header .header-flex{ padding: 0 16px; }
  }

  body.is-scrolled{
    --zen-blur: 24px;
    --zen-sat: 165%;
    --zen-alpha: .18;
    --zen-shadow: .18;
    --zen-stroke: .12;
  }
  body.is-scrolled .adsnord-header header::after{ opacity: .95; transform: translateY(0); }

  @media (prefers-reduced-motion: reduce){
    .adsnord-header header::after{ transition:none !important; }
  }

  /* =========================
     âœ… PATCH: Mobile submenu accordion (arrow toggles, text navigates)
     ========================= */

  /* default closed */
  .adsnord-header #mMenu .mobile-sub-links{ display:none; }
  /* open state */
  .adsnord-header #mMenu .m-link-parent.is-open + .mobile-sub-links{ display:flex; }

  /* arrow button */
  .adsnord-header #mMenu .m-sub-toggle{
    background: rgba(255,255,255,.65);
    border: 1px solid rgba(0,0,0,.06);
    box-shadow: 0 8px 20px rgba(0,0,0,.06);
    width: 38px;
    height: 38px;
    border-radius: 14px;
    display:inline-flex;
    align-items:center;
    justify-content:center;
    cursor:pointer;
    flex: 0 0 auto;
  }
  .adsnord-header #mMenu .m-sub-toggle i{
    font-size: 14px;
    color: #0f172a;
    transition: transform .18s ease;
  }
  .adsnord-header #mMenu .m-link-parent.is-open .m-sub-toggle i{
    transform: rotate(180deg);
  }
</style>

<div class="adsnord-header">
  <div class="scroll-progress" id="progressBar"></div>

  <div class="header-wrapper">
    <header>
      <div class="header-flex">
        <a href="https://adsnord.com/" class="logo-holder">
          <img src="https://adsnord.com/wp-content/uploads/2026/01/my-new-logo-AdsNord-1.png" alt="AdsNord Logo" style="height: 38px; width: auto;">
          <div class="logo-text">Ads<span>Nord</span></div>
        </a>

        <div class="header-actions">
          <!-- âœ… PATCH: accessibility label -->
          <nav aria-label="Primary">
            <ul class="nav-links">
              <li><a href="https://adsnord.com/">Home</a></li>
              <li><a href="https://adsnord.com/contact">Contact</a></li>
              <li><a href="https://adsnord.com/about">About</a></li>

              <!-- âœ… ADDED: Free Tools (desktop dropdown) -->
              <li class="dropdown">
                <!-- âœ… PATCH: aria attributes -->
                <a href="https://adsnord.com/tools" aria-haspopup="true" aria-expanded="false">Free Tools <i class="fa-solid fa-chevron-down"></i></a>
                <ul class="dropdown-menu" role="menu">
                  <li><a role="menuitem" href="https://adsnord.com/tools/keyword-analyzer">Keyword Analyzer</a></li>
                  <li><a role="menuitem" href="https://adsnord.com/tools/campaign-health-score">Campaign Health Score</a></li>
                  <li><a role="menuitem" href="https://adsnord.com/tools/ai-ad-copy-generator">AI Ad Copy Generator</a></li>
                  <li><a role="menuitem" href="https://adsnord.com/tools/ppc-performance-dashboard">PPC Performance Dashboard</a></li>
                  <li><a role="menuitem" href="https://adsnord.com/tools/landing-page-behavior-analysis">Landing Page Behavior Analysis</a></li>
                  <li><a role="menuitem" href="https://adsnord.com/tools/ai-google-ads-self-audit">AI Google Ads Self-Audit</a></li>
                </ul>
              </li>

              <li class="dropdown">
                <a href="https://adsnord.com/services" aria-haspopup="true" aria-expanded="false">Services <i class="fa-solid fa-chevron-down"></i></a>
                <ul class="dropdown-menu" role="menu">
                  <li><a role="menuitem" href="https://adsnord.com/services/google-ads-management/">Google Ads Management</a></li>
                  <li><a role="menuitem" href="https://adsnord.com/services/ppc-keyword-research/">Keyword research and planning</a></li>
                  <li><a role="menuitem" href="https://adsnord.com/services/conversion-rate-optimization/">Landing page optimization</a></li>
                  <li><a role="menuitem" href="https://adsnord.com/services/ppc-audit-service/">Ads audit and analysis</a></li>
                </ul>
              </li>

              <li class="dropdown">
                <a href="https://adsnord.com/blog" aria-haspopup="true" aria-expanded="false">Blog <i class="fa-solid fa-chevron-down"></i></a>
                <ul class="dropdown-menu" role="menu">
                  <li><a role="menuitem" href="https://adsnord.com/category/google-ads-optimization">Google Ads Optimization</a></li>
                  <li><a role="menuitem" href="https://adsnord.com/category/landing-page-optimization">Landing Page Optimization</a></li>
                  <li><a role="menuitem" href="https://adsnord.com/category/keyword-planning">Keyword planning</a></li>
                  <li><a role="menuitem" href="https://adsnord.com/category/google-ads-audit">Google Ads Audit</a></li>
                </ul>
              </li>

              <li class="dropdown">
                <a href="https://adsnord.com/case-studies" aria-haspopup="true" aria-expanded="false">Case Studies <i class="fa-solid fa-chevron-down"></i></a>
                <ul class="dropdown-menu" role="menu">
                  <li><a role="menuitem" href="https://adsnord.com/case-studies/google-ads-management/">Google Ads Management</a></li>
                  <li><a role="menuitem" href="https://adsnord.com/case-studies/keyword-research-and-planning/">Keyword research and Planning</a></li>
                  <li><a role="menuitem" href="https://adsnord.com/case-studies/landing-page-optimization/">Landing page Optimization</a></li>
                  <li><a role="menuitem" href="https://adsnord.com/case-studies/ads-audit-and-analysis/">Ads audit and Analysis</a></li>
                </ul>
              </li>
            </ul>
          </nav>

          <!-- âœ… PATCH: aria for toggle -->
          <button class="menu-btn" id="mToggle" aria-controls="mMenu" aria-expanded="false" aria-label="Open menu">
            <span></span><span></span>
          </button>
        </div>
      </div>
    </header>
  </div>

  <div class="mobile-overlay" id="mMenu" aria-hidden="true">
    <button class="m-close" id="mClose" aria-label="Close menu">
      <i class="fa-solid fa-xmark"></i>
    </button>

    <a href="https://adsnord.com/" class="m-link-main">Home</a>
    <a href="https://adsnord.com/contact" class="m-link-main">Contact</a>
    <a href="https://adsnord.com/about" class="m-link-main">About</a>

    <!-- âœ… ADDED: Free Tools (mobile) -->
    <a href="https://adsnord.com/tools" class="m-link-parent">Free Tools</a>
    <div class="mobile-sub-links">
      <a href="https://adsnord.com/tools/keyword-analyzer">Keyword Analyzer</a>
      <a href="https://adsnord.com/tools/campaign-health-score">Campaign Health Score</a>
      <a href="https://adsnord.com/tools/ai-ad-copy-generator">AI Ad Copy Generator</a>
      <a href="https://adsnord.com/tools/ppc-performance-dashboard">PPC Performance Dashboard</a>
      <a href="https://adsnord.com/tools/landing-page-behavior-analysis">Landing Page Behavior Analysis</a>
      <a href="https://adsnord.com/tools/ai-google-ads-self-audit">AI Google Ads Self-Audit</a>
    </div>

    <a href="https://adsnord.com/services" class="m-link-parent">Services</a>
    <div class="mobile-sub-links">
      <a href="https://adsnord.com/services/google-ads-management/">Google Ads Management</a>
      <a href="https://adsnord.com/services/ppc-keyword-research/">Keyword research and planning</a>
      <a href="https://adsnord.com/services/conversion-rate-optimization/">Landing page optimization</a>
      <a href="https://adsnord.com/services/ppc-audit-service/">Ads audit and analysis</a>
    </div>

    <a href="https://adsnord.com/blog" class="m-link-parent">Blog</a>
    <div class="mobile-sub-links">
      <a href="https://adsnord.com/category/google-ads-optimization">Google Ads Optimization</a>
      <a href="https://adsnord.com/category/landing-page-optimization">Landing Page Optimization</a>
      <a href="https://adsnord.com/category/keyword-planning">Keyword planning</a>
      <a href="https://adsnord.com/category/google-ads-audit">Google Ads Audit</a>
    </div>

    <a href="https://adsnord.com/case-studies" class="m-link-parent">Case Studies</a>
    <div class="mobile-sub-links">
      <a href="https://adsnord.com/case-studies/google-ads-management/">Google Ads Management</a>
      <a href="https://adsnord.com/case-studies/keyword-research-and-planning/">Keyword research and Planning</a>
      <a href="https://adsnord.com/case-studies/landing-page-optimization/">Landing page Optimization</a>
      <a href="https://adsnord.com/case-studies/ads-audit-and-analysis/">Ads audit and Analysis</a>
    </div>
  </div>
</div>

<!-- =========================
     ADSNORD AI (FIXED: single welcome + triggers + form)
     ========================= -->

<style>
  .chat-container{position:fixed;bottom:30px;right:30px;z-index:9999}
  .liquid-orb{
    width:60px;height:60px;
    background:linear-gradient(45deg,#4285F4,#EA4335,#FBBC05,#34A853);
    background-size:400% 400%;
    border-radius:30% 70% 70% 30% / 30% 30% 70% 70%;
    animation:liquid 6s ease-in-out infinite;
    cursor:pointer;display:flex;align-items:center;justify-content:center;
    box-shadow:0 10px 30px rgba(66,133,244,.2)
  }
  .liquid-orb i{color:#fff;font-size:1.4rem}
  @keyframes liquid{
    0%,100%{border-radius:30% 70% 70% 30% / 30% 30% 70% 70%}
    33%{border-radius:70% 30% 50% 50% / 30% 30% 70% 70%}
    66%{border-radius:30% 70% 30% 70% / 70% 30% 70% 30%}
  }
  #adsnord-ai-window{
    display:none;position:fixed;bottom:100px;right:30px;
    width:350px;height:500px;background:rgba(255,255,255,.95);
    backdrop-filter:blur(25px);border:1px solid rgba(0,0,0,.1);
    border-radius:24px;box-shadow:0 20px 40px rgba(0,0,0,.15);
    flex-direction:column;z-index:99999;overflow:hidden;
    font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif
  }
  @media (max-width:480px){
    #adsnord-ai-window{width:90%!important;right:5%!important;left:5%!important;bottom:90px!important;height:65vh!important}
  }
</style>

<div class="chat-container">
  <div class="liquid-orb" onclick="toggleAdsNordAI()">
    <i class="fa-solid fa-wand-magic-sparkles"></i>
  </div>
</div>

<div id="adsnord-ai-window">
  <div style="background:#4285F4;color:#fff;padding:18px;font-weight:900;display:flex;justify-content:space-between;align-items:center">
    <div style="display:flex;align-items:center;gap:8px">
      <i class="fa-solid fa-robot"></i><span>AdsNord AI</span>
    </div>
    <span onclick="toggleAdsNordAI()" style="cursor:pointer;font-size:24px">&times;</span>
  </div>

  <div id="adsnord-ai-messages" style="flex:1;padding:20px;overflow-y:auto;font-size:14px;display:flex;flex-direction:column;gap:12px;color:#0f172a"></div>

  <div style="padding:10px;display:flex;gap:8px;overflow-x:auto;background:rgba(0,0,0,.02);border-top:1px solid rgba(0,0,0,.05)">
    <button onclick="window.open('https://adsnord.com/contact/','_blank')" style="white-space:nowrap;background:#FBBC05;color:#000;border:none;padding:8px 14px;border-radius:20px;font-size:11px;font-weight:800;cursor:pointer">ðŸ“Š Free Audit</button>
    <button onclick="window.open('https://wa.me/46764304702')" style="white-space:nowrap;background:#25D366;color:#fff;border:none;padding:8px 14px;border-radius:20px;font-size:11px;font-weight:800;cursor:pointer"><i class="fa-brands fa-whatsapp"></i> WhatsApp</button>
  </div>

  <div style="padding:15px;border-top:1px solid rgba(0,0,0,.05);display:flex;gap:10px;background:#fff">
    <input type="text" id="adsnord-ai-input" placeholder="Ask about Google Ads..." style="flex:1;border:1px solid #e2e8f0;padding:12px;border-radius:12px;outline:none">
    <button onclick="sendAdsNordAIMsg()" style="background:#4285F4;color:#fff;border:none;width:44px;height:44px;border-radius:12px;cursor:pointer">
      <i class="fa-solid fa-paper-plane"></i>
    </button>
  </div>
</div>

<script>
  const mToggle = document.getElementById('mToggle');
  const mMenu = document.getElementById('mMenu');
  const mClose = document.getElementById('mClose');

  /* âœ… PATCH: close all mobile submenus */
  function closeAllMobileSubmenus(){
    document.querySelectorAll('#mMenu .m-link-parent.is-open').forEach(a => {
      a.classList.remove('is-open');
      a.setAttribute('aria-expanded','false');
    });
  }

  /* âœ… PATCH: inject arrow button inside parent link (arrow toggles, text navigates) */
  (function initMobileAccordion(){
    const parents = document.querySelectorAll('#mMenu .m-link-parent');
    parents.forEach(parent => {
      const next = parent.nextElementSibling;
      if(!next || !next.classList.contains('mobile-sub-links')) return;

      parent.setAttribute('aria-haspopup','true');
      parent.setAttribute('aria-expanded','false');

      if(!parent.querySelector('button.m-sub-toggle')){
        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'm-sub-toggle';
        btn.setAttribute('aria-label','Toggle submenu');
        btn.innerHTML = '<i class="fa-solid fa-chevron-down" aria-hidden="true"></i>';

        /* critical: stop navigation on arrow click */
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();

          const isOpen = parent.classList.contains('is-open');

          /* accordion: close others */
          document.querySelectorAll('#mMenu .m-link-parent.is-open').forEach(a => {
            if(a !== parent){
              a.classList.remove('is-open');
              a.setAttribute('aria-expanded','false');
            }
          });

          parent.classList.toggle('is-open', !isOpen);
          parent.setAttribute('aria-expanded', String(!isOpen));
        });

        parent.appendChild(btn);
      }
    });

    closeAllMobileSubmenus();
  })();

  /* âœ… PATCH: desktop dropdown aria-expanded sync (no behavior change) */
  (function initDesktopDropdownAria(){
    document.querySelectorAll('.nav-links .dropdown').forEach(dd => {
      const trigger = dd.querySelector(':scope > a');
      if(!trigger) return;

      const setExpanded = (v) => trigger.setAttribute('aria-expanded', v ? 'true' : 'false');

      dd.addEventListener('mouseenter', () => setExpanded(true));
      dd.addEventListener('mouseleave', () => setExpanded(false));
      dd.addEventListener('focusin', () => setExpanded(true));
      dd.addEventListener('focusout', (e) => {
        if(!dd.contains(e.relatedTarget)) setExpanded(false);
      });
    });
  })();

  /* âœ… PATCH: menu open/close helpers (aria + scroll lock) */
  function setMenuState(isOpen){
    mMenu.classList.toggle('active', isOpen);
    mToggle.classList.toggle('open', isOpen);
    document.body.classList.toggle('menu-open', isOpen);

    mToggle.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
    mMenu.setAttribute('aria-hidden', isOpen ? 'false' : 'true');
    mToggle.setAttribute('aria-label', isOpen ? 'Close menu' : 'Open menu');

    if(isOpen) closeAllMobileSubmenus();
  }

  if (mClose) {
    mClose.addEventListener('click', () => setMenuState(false));
  }

  mToggle.addEventListener('click', () => {
    const isOpen = !mMenu.classList.contains('active');
    setMenuState(isOpen);
  });

  mMenu.addEventListener('click', (e) => {
    if (e.target === mMenu) setMenuState(false);
  });

  /* âœ… PATCH: close menu ONLY on main links + submenu links (parent text navigates normally) */
  document.querySelectorAll('#mMenu a.m-link-main, #mMenu .mobile-sub-links a').forEach(link => {
    link.addEventListener('click', () => setMenuState(false));
  });

  // progress bar
  window.addEventListener('scroll', () => {
    const p = document.getElementById('progressBar');
    const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
    const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
    const scrolled = (winScroll / height) * 100;
    if(p) p.style.width = scrolled + "%";
  }, { passive: true });

  // is-scrolled + synced hue drift only after scroll
  (function(){
    const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    let ticking = false;

    function updateScrollState(){
      ticking = false;
      const y = window.scrollY || document.documentElement.scrollTop || 0;
      document.body.classList.toggle('is-scrolled', y > 8);
    }

    window.addEventListener('scroll', () => {
      if(!ticking){
        ticking = true;
        requestAnimationFrame(updateScrollState);
      }
    }, { passive: true });

    updateScrollState();
    if (prefersReduced) return;

    let hue = 205;
    const speed = 0.25, tickMs = 220, startAfterPx = 12;
    let timer = null;

    function applyHue(){ document.documentElement.style.setProperty('--zen-hue', hue.toFixed(2)); }
    function startHue(){
      if (timer) return;
      timer = setInterval(() => {
        hue += speed; if (hue >= 360) hue -= 360;
        applyHue();
      }, tickMs);
    }
    function stopHue(){ if (!timer) return; clearInterval(timer); timer = null; }
    function manageHue(){
      const y = window.scrollY || document.documentElement.scrollTop || 0;
      if (y > startAfterPx) startHue(); else stopHue();
    }

    window.addEventListener('scroll', manageHue, { passive: true });
    document.addEventListener('visibilitychange', () => { if (document.hidden) stopHue(); else manageHue(); });

    applyHue(); manageHue();
  })();
</script>

<!-- =========================
     ADSNORD AI SCRIPT (FIXED)
     ========================= -->
<script>
  const ADSNORD_WORKER_URL = 'https://adsnordai.md-motiur52.workers.dev';
  const FORMSPREE_URL = 'https://formspree.io/f/xvzaeokv';
  let adsNordWelcomeSent = false;

  function esc(s){
    return String(s || "")
      .replaceAll('&','&amp;')
      .replaceAll('<','&lt;')
      .replaceAll('>','&gt;')
      .replaceAll('"','&quot;')
      .replaceAll("'","&#039;");
  }

  function isFreeAuditTrigger(text){
    const t = String(text || "").toLowerCase().trim();
    const clean = t.replace(/[^\w\s]/g, " ").replace(/\s+/g, " ").trim();

    const triggers = [
      "get my free audit",
      "i want my free audit",
      "i want a free audit",
      "i need a free audit",
      "want free audit",
      "need free audit",
      "get free audit",
      "free audit",
      "free audits",
      "audit please",
      "i need an audit",
      "send audit",
      "send me an audit",
      "free audit report",
      "audit report",
      "google ads audit",
      "ppc audit",
      "check my ads",
      "review my ads",
      "audit my ads",
      "i want audit",
      "i want audits"
    ];

    if (triggers.some(p => clean.includes(p))) return true;
    if (clean === "audit" || clean === "audits") return true;

    return false;
  }

  function toggleAdsNordAI(){
    const w = document.getElementById('adsnord-ai-window');
    const open = (w.style.display === 'none' || w.style.display === '');
    w.style.display = open ? 'flex' : 'none';

    if(open && !adsNordWelcomeSent){
      adsNordWelcomeSent = true;
      setTimeout(() => {
        const b = document.getElementById('adsnord-ai-messages');
        if(!b) return;
        b.innerHTML += `
          <div style="background:rgba(66,133,244,.10);padding:12px;border-radius:15px;align-self:flex-start;max-width:85%">
            <b>AdsNord AI:</b> Hi! Ask anything about Google Ads. If you want a <b>Free Audit</b>, just type <b>"get my free audit"</b>.
          </div>
        `;
        b.scrollTop = b.scrollHeight;
      }, 600);
    }
  }

  function showLeadForm(){
    const box = document.getElementById('adsnord-ai-messages');
    if(!box) return;

    if (document.getElementById('audit-form-container')) {
      document.getElementById('audit-form-container').scrollIntoView({ behavior: 'smooth', block: 'end' });
      return;
    }

    const formHtml = `
      <div id="audit-form-container" style="background:white;border:1px solid #4285F4;padding:15px;border-radius:15px;margin-top:10px;box-shadow:0 4px 15px rgba(0,0,0,0.1);">
        <form id="adsnord-lead-form">
          <input type="hidden" name="subject" value="ðŸš¨ AdsNord Lead: New Audit Request">
          <p style="margin:0 0 10px 0;font-size:14px;color:#4285F4;font-weight:900;">ðŸ“§ Get your Free Audit Report</p>

          <input type="text" name="website" id="lead-website-input"
            placeholder="Your Website (e.g. adsnord.com)"
            required
            style="width:100%;padding:10px;border:1px solid #ddd;border-radius:8px;margin-bottom:10px;font-size:14px;">

          <input type="email" name="email" id="lead-email-input" placeholder="Your Email Address" required
            style="width:100%;padding:10px;border:1px solid #ddd;border-radius:8px;margin-bottom:10px;font-size:14px;">

          <button type="submit" id="submit-btn"
            style="width:100%;background:#4285F4;color:white;border:none;padding:10px;border-radius:8px;font-weight:900;cursor:pointer;">
            Get My Audit
          </button>
        </form>
      </div>
    `;

    box.innerHTML += formHtml;
    box.scrollTop = box.scrollHeight;

    const form = document.getElementById('adsnord-lead-form');
    form.addEventListener('submit', async function(e){
      e.preventDefault();

      const website = document.getElementById('lead-website-input').value.trim();
      const email = document.getElementById('lead-email-input').value.trim();
      const btn = document.getElementById('submit-btn');

      btn.innerText = "Sending...";
      btn.disabled = true;

      try{
        const response = await fetch(FORMSPREE_URL, {
          method: 'POST',
          body: JSON.stringify({ email, website, subject: "ðŸš¨ AdsNord Lead: New Audit Request" }),
          headers: { 'Accept': 'application/json', 'Content-Type': 'application/json' }
        });

        if (response.ok) {
          document.getElementById('audit-form-container').innerHTML =
            "<p style='color:#16a34a;font-weight:900;margin:0;text-align:center;'>âœ… Success! Check your email soon.</p>";
        } else {
          btn.innerText = "Get My Audit";
          btn.disabled = false;
          alert("Something went wrong. Please check your internet.");
        }
      } catch(err){
        console.error(err);
        btn.innerText = "Get My Audit";
        btn.disabled = false;
        alert("Network error. Please try again.");
      }
    });
  }

  async function sendAdsNordAIMsg(){
    const i = document.getElementById('adsnord-ai-input');
    const b = document.getElementById('adsnord-ai-messages');
    if(!i || !b) return;

    const userMsg = i.value.trim();
    if(!userMsg) return;

    b.innerHTML += `<div style="background:#4285F4;color:#fff;padding:12px;border-radius:15px;align-self:flex-end;max-width:85%">${esc(userMsg)}</div>`;
    i.value = '';

    if (isFreeAuditTrigger(userMsg)) {
      showLeadForm();
    }

    const loadingId = "loading-" + Date.now();
    b.innerHTML += `<div id="${loadingId}" style="color:#94a3b8;font-size:12px">Typing...</div>`;
    b.scrollTop = b.scrollHeight;

    try{
      const res = await fetch(ADSNORD_WORKER_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message: userMsg })
      });

      const data = await res.json();
      const loadingEl = document.getElementById(loadingId);
      if(loadingEl) loadingEl.remove();

      const reply = (data && data.reply) ? String(data.reply) : "Sorry, please try again.";

      if (reply.trim().endsWith("[SHOW_FORM]")) {
        const cleanReply = reply.replace("[SHOW_FORM]", "").trim();
        b.innerHTML += `<div style="background:rgba(0,0,0,.05);padding:12px;border-radius:15px;align-self:flex-start;max-width:85%;border:1px solid rgba(0,0,0,.05)"><b>AdsNord AI:</b> ${esc(cleanReply)}</div>`;
        showLeadForm();
      } else {
        b.innerHTML += `<div style="background:rgba(0,0,0,.05);padding:12px;border-radius:15px;align-self:flex-start;max-width:85%;border:1px solid rgba(0,0,0,.05)"><b>AdsNord AI:</b> ${esc(reply)}</div>`;
      }
    }catch{
      const loadingEl = document.getElementById(loadingId);
      if(loadingEl) loadingEl.innerText = "Error.";
    }

    b.scrollTop = b.scrollHeight;
  }

  document.addEventListener('keydown', (e) => {
    if(e.key === 'Enter'){
      const el = document.getElementById('adsnord-ai-input');
      if(el && document.activeElement === el){
        e.preventDefault();
        sendAdsNordAIMsg();
      }
    }
  });
</script>
